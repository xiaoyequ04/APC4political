ggarrange(
plot_period_cohort_demlevel,
plot_period_cohort_demsatisy,
plot_period_cohort_concpet,
ncol = 3, nrow = 1)
ggarrange(
plot_period_cohort_demlevel,
plot_period_cohort_demsatisify,
plot_period_cohort_concpet,
ncol = 3, nrow = 1)
ggarrange(
plot_period_cohort_demlevel,
plot_period_cohort_demsatisify,
plot_period_cohort_concept,
ncol = 3, nrow = 1)
u0_cohort_concept <- ranef(lm_concept, condVar = TRUE)
names(u0_cohort_concept$year) <- "est_concept"
names(u0_cohort_concept$cohort) <- "est_concept"
u0_cohort_concept
est = u0_cohort_concept$year
est
u0_cohort_concept <- ranef(lm_concept, condVar = TRUE)
names(u0_cohort_concept$year) <- "est_concept"
names(u0_cohort_concept$cohort) <- "est_concept"
period_eff_cohort_concept <- data.frame(est_concept = u0_cohort_concept$year,
se = sqrt(attr(u0_cohort_concept[[2]], "postVar")[1, ,]),
period = c(2011, 2014, 2019))
cohort_eff_cohort_concept <- data.frame(est_concept = u0_cohort_concept$cohort,
se = sqrt(attr(u0_cohort_concept[[1]], "postVar")[1, ,]),
cohort = c("1905/1945",
"1946/1960",
"1961/1970",
"1971/1980",
"1981/2001"))
period_eff_cohort_concept$upper <- period_eff_cohort_concept$est_concept + 1.96*period_eff_cohort_concept$se
period_eff_cohort_concept$lower <- period_eff_cohort_concept$est_concept - 1.96*period_eff_cohort_concept$se
cohort_eff_cohort_concept$upper <- cohort_eff_cohort_concept$est_concept + 1.96*cohort_eff_cohort_concept$se
cohort_eff_cohort_concept$lower <- cohort_eff_cohort_concept$est_concept - 1.96*cohort_eff_cohort_concept$se
u0_cohort_demlevel <- ranef(lm_demlevel, condVar = TRUE)
names(u0_cohort_demlevel$year) <- "est_demlevel"
names(u0_cohort_demlevel$cohort) <- "est_demlevel"
period_eff_cohort_demlevel <- data.frame(est_demlevel = u0_cohort_demlevel$year,
se = sqrt(attr(u0_cohort_demlevel[[2]], "postVar")[1, ,]),
period = c(2008,2011, 2014, 2019))
cohort_eff_cohort_demlevel <- data.frame(est_demlevel = u0_cohort_demlevel$cohort,
se = sqrt(attr(u0_cohort_demlevel[[1]], "postVar")[1, ,]),
cohort = c("1905/1945",
"1946/1960",
"1961/1970",
"1971/1980",
"1981/2001"))
period_eff_cohort_demlevel$upper <- period_eff_cohort_demlevel$est_demlevel + 1.96*period_eff_cohort_demlevel$se
period_eff_cohort_demlevel$lower <- period_eff_cohort_demlevel$est_demlevel - 1.96*period_eff_cohort_demlevel$se
cohort_eff_cohort_demlevel$upper <- cohort_eff_cohort_demlevel$est_demlevel + 1.96*cohort_eff_cohort_demlevel$se
cohort_eff_cohort_demlevel$lower <- cohort_eff_cohort_demlevel$est_demlevel - 1.96*cohort_eff_cohort_demlevel$se
u0_cohort_demsatisify <- ranef(lm_demsatisify, condVar = TRUE)
names(u0_cohort_demsatisify$year) <- "est_demsatisify"
names(u0_cohort_demsatisify$cohort) <- "est_demsatisify"
period_eff_cohort_demsatisify <- data.frame(est_demsatisify = u0_cohort_demsatisify$year,
se = sqrt(attr(u0_cohort_demsatisify[[2]], "postVar")[1, ,]),
period = c(2008,2011, 2014, 2019))
cohort_eff_cohort_demsatisify <- data.frame(est_demsatisify = u0_cohort_demsatisify$cohort,
se = sqrt(attr(u0_cohort_demsatisify[[1]], "postVar")[1, ,]),
cohort = c("1905/1945",
"1946/1960",
"1961/1970",
"1971/1980",
"1981/2001"))
period_eff_cohort_demsatisify$upper <- period_eff_cohort_demsatisify$est_demsatisify + 1.96*period_eff_cohort_demsatisify$se
period_eff_cohort_demsatisify$lower <- period_eff_cohort_demsatisify$est_demsatisify - 1.96*period_eff_cohort_demsatisify$se
cohort_eff_cohort_demsatisify$upper <- cohort_eff_cohort_demsatisify$est_demsatisify + 1.96*cohort_eff_cohort_demsatisify$se
cohort_eff_cohort_demsatisify$lower <- cohort_eff_cohort_demsatisify$est_demsatisify - 1.96*cohort_eff_cohort_demsatisify$se
period_eff_cohort_concept$period <- as.factor(period_eff_cohort_concept$period)
period_eff_cohort_demsatisify$period <- as.factor(period_eff_cohort_demsatisify$period)
period_eff_cohort_demlevel$period <- as.factor(period_eff_cohort_demlevel$period)
plot_period_cohort_concept <- ggplot(period_eff_cohort_concept, aes(x = period, y = est_concept)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .15) +
scale_y_continuous(limits = c(-.1,.1)) +
xlab("Year") +
ylab("The period effect of Concept")
plot_period_cohort_demlevel <- ggplot(period_eff_cohort_level, aes(x = period, y = est_demlevel)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .15) +
scale_y_continuous(limits = c(-1,1)) +
xlab("Year") +
ylab("The period effect of Demlevel")
plot_period_cohort_demsatisify <- ggplot(period_eff_cohort_demsatisify, aes(x = period, y = est_demsatisify)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .15) +
scale_y_continuous(limits = c(-1,1)) +
xlab("Year") +
ylab("The period effect of Demsatisify")
plot_cohort_cohort_concpet <- ggplot(cohort_eff_cohort_concept, aes(x = cohort, y = est_concept)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .2) +
scale_y_continuous(limits = c(-.1, .1)) +
xlab("Cohort") +
ylab("The cohort effect of Concept")
plot_cohort_cohort_demlevel <- ggplot(cohort_eff_cohort_level, aes(x = cohort, y = est_demlevel)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .2) +
scale_y_continuous(limits = c(-1,1)) +
xlab("Cohort") +
ylab("The cohort effect of Demlevel")
plot_cohort_cohort_demsatisify <- ggplot(cohort_eff_cohort_demsatisify, aes(x = cohort, y = est_demsatisify)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .2) +
scale_y_continuous(limits = c(-1,1)) +
xlab("Cohort") +
ylab("The cohort effect of Demsatisify")
ggarrange(
plot_cohort_cohort_demlevel,
plot_period_cohort_demsatisify,
plot_cohort_cohort_concpet,
ncol = 3, nrow = 1)
ggarrange(
plot_cohort_cohort_demlevel,
plot_cohort_cohort_demsatisify,
plot_cohort_cohort_concpet,
ncol = 3, nrow = 1)
ggarrange(
plot_period_cohort_demlevel,
plot_period_cohort_demsatisify,
plot_period_cohort_concept,
ncol = 3, nrow = 1)
#| label: cohort_effect_concpt10
lm_concept10 <- lmerTest::lmer(demscore ~ age + female + party + edu + interstpol + frepol + socialLevel + hukouRural + marriage  + (1|cohort10) + (1|year),data = cbs,weights = weight)
lm_demlevel10 <- update(lm_concept10,demlevel ~.)
lm_demsatisify10 <- update(lm_concept10,demsatisify ~.)
# Extract the random effect
u0_cohort10_concept <- ranef(lm_concept10, condVar = TRUE)
names(u0_cohort10_concept$year) <- "est_concept"
names(u0_cohort10_concept$cohort10) <- "est_concept"
period_eff_cohort10_concept <- data.frame(est_concept = u0_cohort10_concept$year,
se = sqrt(attr(u0_cohort10_concept[[2]], "postVar")[1, ,]),
period = c(2011, 2014, 2019))
u0_cohort10_concept
View(cbs$cohort10)
table(cbs$cohort10)
u0_cohort10_concept <- ranef(lm_concept10, condVar = TRUE)
names(u0_cohort10_concept$year) <- "est_concept"
names(u0_cohort10_concept$cohort10) <- "est_concept"
period_eff_cohort10_concept <- data.frame(est_concept = u0_cohort10_concept$year,
se = sqrt(attr(u0_cohort10_concept[[2]], "postVar")[1, ,]),
period = c(2011, 2014, 2019))
cohort_eff_cohort10_concept <- data.frame(est_concept = u0_cohort10_concept$cohort10,
se = sqrt(attr(u0_cohort10_concept[[1]], "postVar")[1, ,]),
cohort10 = c("1905/1948",
"1949/1958",
"1959/1968",
"1969/1978",
"1979/1988",
"1981/2001"))
period_eff_cohort10_concept$upper <- period_eff_cohort10_concept$est_concept + 1.96*period_eff_cohort10_concept$se
period_eff_cohort10_concept$lower <- period_eff_cohort10_concept$est_concept - 1.96*period_eff_cohort10_concept$se
cohort_eff_cohort10_concept$upper <- cohort_eff_cohort10_concept$est_concept + 1.96*cohort10_eff_cohort10_concept$se
cohort_eff_cohort10_concept$upper <- cohort_eff_cohort10_concept$est_concept + 1.96*cohort_eff_cohort10_concept$se
cohort_eff_cohort10_concept$lower <- cohort_eff_cohort10_concept$est_concept - 1.96*cohort_eff_cohort10_concept$se
u0_cohort10_demlevel <- ranef(lm_demlevel, condVar = TRUE)
names(u0_cohort10_demlevel$year) <- "est_demlevel"
names(u0_cohort10_demlevel$cohort10) <- "est_demlevel"
u0_cohort10_demlevel <- ranef(lm_demlevel10, condVar = TRUE)
names(u0_cohort10_demlevel10$year) <- "est_demlevel"
u0_cohort10_demlevel <- ranef(lm_demlevel10, condVar = TRUE)
names(u0_cohort10_demlevel$year) <- "est_demlevel"
names(u0_cohort10_demlevel$cohort10) <- "est_demlevel"
period_eff_cohort10_demlevel <- data.frame(est_demlevel = u0_cohort10_demlevel$year,
se = sqrt(attr(u0_cohort10_demlevel[[2]], "postVar")[1, ,]),
period = c(2008,2011, 2014, 2019))
cohort_eff_cohort10_demlevel <- data.frame(est_demlevel = u0_cohort10_demlevel$cohort10,
se = sqrt(attr(u0_cohort10_demlevel[[1]], "postVar")[1, ,]),
cohort10 = c("1905/1948",
"1949/1958",
"1959/1968",
"1969/1978",
"1979/1988",
"1981/2001"))
period_eff_cohort10_demlevel$upper <- period_eff_cohort10_demlevel$est_demlevel + 1.96*period_eff_cohort10_demlevel$se
period_eff_cohort10_demlevel$lower <- period_eff_cohort10_demlevel$est_demlevel - 1.96*period_eff_cohort10_demlevel$se
cohort_eff_cohort10_demlevel$upper <- cohort_eff_cohort10_demlevel$est_demlevel + 1.96*cohort10_eff_cohort10_demlevel$se
cohort_eff_cohort10_demlevel$upper <- cohort_eff_cohort10_demlevel$est_demlevel + 1.96*cohort_eff_cohort10_demlevel$se
cohort_eff_cohort10_demlevel$lower <- cohort_eff_cohort10_demlevel$est_demlevel - 1.96*cohort_eff_cohort10_demlevel$se
u0_cohort10_demsatisify <- ranef(lm_demsatisify10, condVar = TRUE)
names(u0_cohort10_demsatisify$year) <- "est_demsatisify"
names(u0_cohort10_demsatisify$cohort10) <- "est_demsatisify"
period_eff_cohort10_demsatisify <- data.frame(est_demsatisify = u0_cohort10_demsatisify$year,
se = sqrt(attr(u0_cohort10_demsatisify[[2]], "postVar")[1, ,]),
period = c(2008,2011, 2014, 2019))
cohort_eff_cohort10_demsatisify <- data.frame(est_demsatisify = u0_cohort10_demsatisify$cohort10,
se = sqrt(attr(u0_cohort10_demsatisify[[1]], "postVar")[1, ,]),
cohort10 = c("1905/1948",
"1949/1958",
"1959/1968",
"1969/1978",
"1979/1988",
"1981/2001"))
period_eff_cohort10_demsatisify$upper <- period_eff_cohort10_demsatisify$est_demsatisify + 1.96*period_eff_cohort10_demsatisify$se
period_eff_cohort10_demsatisify$lower <- period_eff_cohort10_demsatisify$est_demsatisify - 1.96*period_eff_cohort10_demsatisify$se
cohort_eff_cohort10_demsatisify$upper <- cohort_eff_cohort10_demsatisify$est_demsatisify + 1.96*cohort_eff_cohort10_demsatisify$se
cohort_eff_cohort10_demsatisify$lower <- cohort_eff_cohort10_demsatisify$est_demsatisify - 1.96*cohort_eff_cohort10_demsatisify$se
period_eff_cohort10_concept$period <- as.factor(period_eff_cohort10_concept$period)
period_eff_cohort10_demsatisify$period <- as.factor(period_eff_cohort10_demsatisify$period)
period_eff_cohort10_demlevel$period <- as.factor(period_eff_cohort10_demlevel$period)
plot_period_cohort10_concept <- ggplot(period_eff_cohort10_concept, aes(x = period, y = est_concept)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .15) +
scale_y_continuous(limits = c(-.1,.1)) +
xlab("Year") +
ylab("The period effect of Concept")
plot_period_cohort10_demlevel <- ggplot(period_eff_cohort10_level, aes(x = period, y = est_demlevel)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .15) +
scale_y_continuous(limits = c(-1,1)) +
xlab("Year") +
ylab("The period effect of Demlevel")
plot_period_cohort10_demlevel <- ggplot(period_eff_cohort10_demlevel, aes(x = period, y = est_demlevel)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .15) +
scale_y_continuous(limits = c(-1,1)) +
xlab("Year") +
ylab("The period effect of Demlevel")
plot_period_cohort10_demsatisify <- ggplot(period_eff_cohort10_demsatisify, aes(x = period, y = est_demsatisify)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .15) +
scale_y_continuous(limits = c(-1,1)) +
xlab("Year") +
ylab("The period effect of Demsatisify")
plot_cohort_cohort10_concpet <- ggplot(cohort_eff_cohort10_concept, aes(x = cohort10, y = est_concept)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .2) +
scale_y_continuous(limits = c(-.1, .1)) +
xlab("cohort10") +
ylab("The cohort10 effect of Concept")
plot_cohort_cohort10_demlevel <- ggplot(cohort10_eff_cohort10_demlevel, aes(x = cohort10, y = est_demlevel)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .2) +
scale_y_continuous(limits = c(-1,1)) +
xlab("cohort10") +
ylab("The cohort10 effect of Demlevel")
plot_cohort_cohort10_demlevel <- ggplot(cohort_eff_cohort10_demlevel, aes(x = cohort10, y = est_demlevel)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .2) +
scale_y_continuous(limits = c(-1,1)) +
xlab("cohort10") +
ylab("The cohort10 effect of Demlevel")
plot_cohort_cohort10_demsatisify <- ggplot(cohort_eff_cohort10_demsatisify, aes(x = cohort10, y = est_demsatisify)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .2) +
scale_y_continuous(limits = c(-1,1)) +
xlab("cohort10") +
ylab("The cohort10 effect of Demsatisify")
plot_cohort_cohort10_effect <- ggarrange(
plot_cohort_cohort10_demlevel,
plot_cohort_cohort10_demsatisify,
plot_cohort_cohort10_concpet,
ncol = 3, nrow = 1)
plot_period_cohort10_effect <- ggarrange(
plot_period_cohort10_demlevel,
plot_period_cohort10_demsatisify,
plot_period_cohort10_concept,
ncol = 3, nrow = 1)
plot_cohort_cohort10_effect
plot_period_cohort10_effect
plot_cohort_cohort10_effect
lm_concept5 <- lmerTest::lmer(demscore ~ age + female + party + edu + interstpol + frepol + socialLevel + hukouRural + marriage  + (1|cohort5) + (1|year),data = cbs,weights = weight)
lm_demlevel5 <- update(lm_concept5,demlevel ~.)
lm_demsatisify5 <- update(lm_concept5,demsatisify ~.)
u0_cohort5_concept <- ranef(lm_concept5, condVar = TRUE)
names(u0_cohort5_concept$year) <- "est_concept"
names(u0_cohort5_concept$cohort5) <- "est_concept"
period_eff_cohort5_concept <- data.frame(est_concept = u0_cohort5_concept$year,
se = sqrt(attr(u0_cohort5_concept[[2]], "postVar")[1, ,]),
period = c(2011, 2014, 2019))
cohort_eff_cohort5_concept <- data.frame(est_concept = u0_cohort5_concept$cohort5,
se = sqrt(attr(u0_cohort5_concept[[1]], "postVar")[1, ,]),
cohort5 = c("1905/1948",
"1949/1958",
"1959/1968",
"1969/1978",
"1979/1988",
"1981/2001"))
cohort_eff_cohort5_concept <- data.frame(est_concept = u0_cohort5_concept$cohort5,
se = sqrt(attr(u0_cohort5_concept[[1]], "postVar")[1, ,]),
cohort5 = c("1905/1948",
"1949/1954",
"1955/1959",
"1960/1964",
"1965/1969",
"1970/1974",
"1975/1979",
"1980/1984",
"1990/1989",
"1990/1994",
"1995/2001"))
period_eff_cohort5_concept$upper <- period_eff_cohort5_concept$est_concept + 1.96*period_eff_cohort5_concept$se
period_eff_cohort5_concept$lower <- period_eff_cohort5_concept$est_concept - 1.96*period_eff_cohort5_concept$se
cohort_eff_cohort5_concept$upper <- cohort_eff_cohort5_concept$est_concept + 1.96*cohort_eff_cohort5_concept$se
cohort_eff_cohort5_concept$lower <- cohort_eff_cohort5_concept$est_concept - 1.96*cohort_eff_cohort5_concept$se
u0_cohort5_demlevel <- ranef(lm_demlevel5, condVar = TRUE)
names(u0_cohort5_demlevel$year) <- "est_demlevel"
names(u0_cohort5_demlevel$cohort5) <- "est_demlevel"
period_eff_cohort5_demlevel <- data.frame(est_demlevel = u0_cohort5_demlevel$year,
se = sqrt(attr(u0_cohort5_demlevel[[2]], "postVar")[1, ,]),
period = c(2008,2011, 2014, 2019))
cohort_eff_cohort5_demlevel <- data.frame(est_demlevel = u0_cohort5_demlevel$cohort5,
se = sqrt(attr(u0_cohort5_demlevel[[1]], "postVar")[1, ,]),
cohort5 = c("1905/1948",
"1949/1958",
"1959/1968",
"1969/1978",
"1979/1988",
"1981/2001"))
cohort_eff_cohort5_demlevel <- data.frame(est_demlevel = u0_cohort5_demlevel$cohort5,
se = sqrt(attr(u0_cohort5_demlevel[[1]], "postVar")[1, ,]),
cohort5 = c("1905/1948",
"1949/1954",
"1955/1959",
"1960/1964",
"1965/1969",
"1970/1974",
"1975/1979",
"1980/1984",
"1990/1989",
"1990/1994",
"1995/2001"))
period_eff_cohort5_demlevel$upper <- period_eff_cohort5_demlevel$est_demlevel + 1.96*period_eff_cohort5_demlevel$se
period_eff_cohort5_demlevel$lower <- period_eff_cohort5_demlevel$est_demlevel - 1.96*period_eff_cohort5_demlevel$se
cohort_eff_cohort5_demlevel$upper <- cohort_eff_cohort5_demlevel$est_demlevel + 1.96*cohort_eff_cohort5_demlevel$se
cohort_eff_cohort5_demlevel$lower <- cohort_eff_cohort5_demlevel$est_demlevel - 1.96*cohort_eff_cohort5_demlevel$se
u0_cohort5_demsatisify <- ranef(lm_demsatisify10, condVar = TRUE)
names(u0_cohort5_demsatisify$year) <- "est_demsatisify"
names(u0_cohort5_demsatisify$cohort5) <- "est_demsatisify"
u0_cohort5_demsatisify <- ranef(lm_demsatisify5, condVar = TRUE)
names(u0_cohort5_demsatisify$year) <- "est_demsatisify"
names(u0_cohort5_demsatisify$cohort5) <- "est_demsatisify"
period_eff_cohort5_demsatisify <- data.frame(est_demsatisify = u0_cohort5_demsatisify$year,
se = sqrt(attr(u0_cohort5_demsatisify[[2]], "postVar")[1, ,]),
period = c(2008,2011, 2014, 2019))
cohort_eff_cohort5_demsatisify <- data.frame(est_demsatisify = u0_cohort5_demsatisify$cohort5,
se = sqrt(attr(u0_cohort5_demsatisify[[1]], "postVar")[1, ,]),
cohort5 = c("1905/1948",
"1949/1954",
"1955/1959",
"1960/1964",
"1965/1969",
"1970/1974",
"1975/1979",
"1980/1984",
"1990/1989",
"1990/1994",
"1995/2001"))
period_eff_cohort5_demsatisify$upper <- period_eff_cohort5_demsatisify$est_demsatisify + 1.96*period_eff_cohort5_demsatisify$se
period_eff_cohort5_demsatisify$lower <- period_eff_cohort5_demsatisify$est_demsatisify - 1.96*period_eff_cohort5_demsatisify$se
cohort_eff_cohort5_demsatisify$upper <- cohort_eff_cohort5_demsatisify$est_demsatisify + 1.96*cohort_eff_cohort5_demsatisify$se
cohort_eff_cohort5_demsatisify$lower <- cohort_eff_cohort5_demsatisify$est_demsatisify - 1.96*cohort_eff_cohort5_demsatisify$se
period_eff_cohort5_concept$period <- as.factor(period_eff_cohort5_concept$period)
period_eff_cohort5_demsatisify$period <- as.factor(period_eff_cohort5_demsatisify$period)
period_eff_cohort5_demlevel$period <- as.factor(period_eff_cohort5_demlevel$period)
plot_period_cohort5_concept <- ggplot(period_eff_cohort5_concept, aes(x = period, y = est_concept)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .15) +
scale_y_continuous(limits = c(-.1,.1)) +
xlab("Year") +
ylab("The period effect of Concept")
# plot_period_cohort5_concept
plot_period_cohort5_demlevel <- ggplot(period_eff_cohort5_demlevel, aes(x = period, y = est_demlevel)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .15) +
scale_y_continuous(limits = c(-1,1)) +
xlab("Year") +
ylab("The period effect of Demlevel")
# plot_period_cohort5_demlevel
plot_period_cohort5_demsatisify <- ggplot(period_eff_cohort5_demsatisify, aes(x = period, y = est_demsatisify)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .15) +
scale_y_continuous(limits = c(-1,1)) +
xlab("Year") +
ylab("The period effect of Demsatisify")
# plot_period_cohort5_demsatisify
plot_cohort_cohort5_concpet <- ggplot(cohort_eff_cohort5_concept, aes(x = cohort5, y = est_concept)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .2) +
scale_y_continuous(limits = c(-.1, .1)) +
xlab("cohort5") +
ylab("The cohort5 effect of Concept")
# plot_cohort5_cohort5_concpet
plot_cohort_cohort5_demlevel <- ggplot(cohort_eff_cohort5_demlevel, aes(x = cohort5, y = est_demlevel)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .2) +
scale_y_continuous(limits = c(-1,1)) +
xlab("cohort5") +
ylab("The cohort5 effect of Demlevel")
# plot_cohort5_cohort5_demlevel
plot_cohort_cohort5_demsatisify <- ggplot(cohort_eff_cohort5_demsatisify, aes(x = cohort5, y = est_demsatisify)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .2) +
scale_y_continuous(limits = c(-1,1)) +
xlab("cohort5") +
ylab("The cohort5 effect of Demsatisify")
# plot_cohort5_cohort5_demsatisify
plot_cohort_cohort5_effect <- ggarrange(
plot_cohort_cohort5_demlevel,
plot_cohort_cohort5_demsatisify,
plot_cohort_cohort5_concpet,
ncol = 3, nrow = 1)
plot_period_cohort5_effect <- ggarrange(
plot_period_cohort5_demlevel,
plot_period_cohort5_demsatisify,
plot_period_cohort5_concept,
ncol = 3, nrow = 1)
plot_cohort_cohort5_effect
plot_cohort_cohort5_demsatisify <- ggplot(cohort_eff_cohort5_demsatisify, aes(x = cohort5, y = est_demsatisify)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .2) +
scale_y_continuous(limits = c(-1,1)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
xlab("cohort5") +
ylab("The cohort5 effect of Demsatisify")
plot_cohort5_cohort5_demsatisify
plot_cohort_cohort5_demsatisify
#| label: leader
lm_leader_cohort <- lmerTest::lmer(leader ~ age + female + party + edu + interstpol + socialLevel + marriage  + (1|cohort) + (1|year),
data = cbs,
weights = weight
)
#| label: leader
lm_leader_cohort <- lmerTest::lmer(leader ~ age + female + party + edu + interstpol + frepol + socialLevel + marriage  + (1|cohort) + (1|year),
data = cbs,
weights = weight
)
lm_leader_cohort10 <- update(lm_leader_cohort,. ~ -(1|cohort) + (1|cohort10))
summary(lm_leader_cohort10)
lm_leader_cohort10 <- update(lm_leader_cohort,. ~ -(1|cohort) + (1|cohort10))
lm_leader_cohort5 <- update(lm_leader,. ~ - -(1|cohort) + (1|cohort5))
u0_leader <- ranef(lm_leader_cohort, condVar = TRUE)
names(u0_leader$year) <- "est_leader"
names(u0_leader$cohort10) <- "est_leader"
u0_leader <- ranef(lm_leader_cohort, condVar = TRUE)
names(u0_leader$year) <- "est_leader"
names(u0_leader$cohort) <- "est_leader"
cohort_leader <- data.frame(est_leader = u0_leader$cohort,
se = sqrt(attr(u0_leader[[1]], "postVar")[1, ,]),
cohort = c("1905/1945",
"1946/1960",
"1961/1970",
"1971/1980",
"1981/2001"))
period_leader$upper <- period_leader$est_leader + 1.96*period_leader$se
#Extract the standard error
period_leader <- data.frame(est_leader = u0_leader$year,
se = sqrt(attr(u0_leader[[2]], "postVar")[1, ,]),
period = c(2002,2008,2011, 2014, 2019))
u0_leader
t2_cbs
#Extract the standard error
period_leader <- data.frame(est_leader = u0_leader$year,
se = sqrt(attr(u0_leader[[2]], "postVar")[1, ,]),
period = c(2008,2011, 2014, 2019))
cohort_leader <- data.frame(est_leader = u0_leader$cohort,
se = sqrt(attr(u0_leader[[1]], "postVar")[1, ,]),
cohort = c("1905/1945",
"1946/1960",
"1961/1970",
"1971/1980",
"1981/2001"))
period_leader$upper <- period_leader$est_leader + 1.96*period_leader$se
period_leader$lower <- period_leader$est_leader - 1.96*period_leader$se
cohort_leader$upper <- cohort_leader$est_leader + 1.96*cohort_leader$se
cohort_leader$lower <- cohort_leader$est_leader - 1.96*cohort_leader$se
plot_period_leader <- ggplot(period_leader, aes(x = period, y = est)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .2) +
xlab("Year") +
ylab("The period effect of Leader")
plot_period_leader
period_leader$period <- as.factor(period_leader$period)
plot_period_leader <- ggplot(period_leader, aes(x = period, y = est)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .2) +
xlab("Year") +
ylab("The period effect of Leader")
plot_period_leader
rlang::last_trace()
View(period_leader)
plot_period_leader <- ggplot(period_leader, aes(x = period, y = est_leader)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .2) +
xlab("Year") +
ylab("The period effect of Leader")
plot_period_leader
plot_cohort_leader <- ggplot(cohort_eff, aes(x = cohort, y = est)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .2) +
scale_y_continuous(limits = c(-.5,.5)) +
xlab("Cohort") +
ylab("Conditional log odds of the cohort effect")
plot_period_leader
plot_cohort_leader <- ggplot(cohort_eff, aes(x = cohort, y = est)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .2) +
scale_y_continuous(limits = c(-.1,.1)) +
xlab("Cohort") +
ylab("Conditional log odds of the cohort effect")
plot_period_leader
plot_cohort_leader <- ggplot(cohort_eff, aes(x = cohort, y = est)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = .2) +
scale_y_continuous(limits = c(-1,1)) +
xlab("Cohort") +
ylab("Conditional log odds of the cohort effect")
plot_period_leader
